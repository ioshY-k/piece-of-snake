extends Node


const SPEED_BOOST_SPEED = 0.19
const NORMAL_SPEED = 0.38
const TILE_SIZE = 80

enum CHAR_LIST {OSTRICH, PYTHON, SALAMANDER, CHAMELEON, ELEPHANT, TWOHEAD, RETRO, CENTIPEDE}

enum MAP_LIST {WOODS,STADIUM,OFFICE,CAVE,DISCO,BEACH,RESTAURANT,TOMB, TRAIN}

enum MAP_MODS {NO_MAPMOD, CAFFEINATED, TAILVIRUS, EDIBLE_PAPER, LASER, FRUIT_BODY, TETRI_FRUIT, MOVING_FRUIT, ANTI_MAGNET, GHOST_INVASION, FAR_AWAY, DARK, UFO, HEAD_SWAP}

enum KEYWORDS {ADVAMCEMENT, TASTY, DENSE, HOLLOW, SHIELDED, GHOST_FRUIT, PHASING}

enum GAMEMODES {EASY, NORMAL, HARD, ASCENSION}

enum UPGRADE_TYPE {DEFAULT, PASSIVE, BODYMOD, SYNERGY, ACTIVE, SPECIAL}
enum UPGRADE_LIST {	AREA_SIZE_1, AREA_SIZE_2, AREA_SIZE_3,
					FRUIT_MAGNET_1, FRUIT_MAGNET_2, FRUIT_MAGNET_3,
					HYPER_SPEED_1, HYPER_SPEED_2, HYPER_SPEED_3,
					DOUBLE_FRUIT_1, DOUBLE_FRUIT_2, DOUBLE_FRUIT_3,
					EDGE_WRAP, 
					FRUIT_RELOCATOR_1, FRUIT_RELOCATOR_2, FRUIT_RELOCATOR_3,
					CROSS_ROAD_1, CROSS_ROAD_2, CROSS_ROAD_3,
					TAIL_CUT,
					KNOT_SLOWMO,
					ITEM_RELOADER,
					IMMUTABLE,
					TIME_STOP_1, TIME_STOP_2, TIME_STOP_3,
					WORMHOLE_1, WORMHOLE_2, WORMHOLE_3,
					CORNER_PHASING,
					MOULTING,
					ANCHOR,
					PIGGY_BANK,
					SALE,
					DIET_1, DIET_2, DIET_3,
					COATING,
					STEEL_HELMET,
					FUEL_1,FUEL_2,FUEL_3,
					RUBBER_BAND,
					SWISS_KNIVE,
					MAGIC_FLUTE_1, MAGIC_FLUTE_2, MAGIC_FLUTE_3,
					PACMAN_1, PACMAN_2, PACMAN_3,
					PLANT_SNAKE,
					HEAD_LIGHT,
					SHINY_GHOST,
					DANCE,
					HALF_GONE,
					ALLERGY,
					SNEK_1, SNEK_2, SNEK_3,
					POWER_NAP,
					CATCH,
					DIFFUSION,
					BIG_FRUIT_1, BIG_FRUIT_2, BIG_FRUIT_3,
					OVERFED, DEAD_MOUSE,
					DRAGONFLY_1, DRAGONFLY_2, DRAGONFLY_3,
					MAYFLY_1, MAYFLY_2, MAYFLY_3,
					BUMBLEBEE_1, BUMBLEBEE_2, BUMBLEBEE_3}

var advanced_upgrades: Array[int] = [	UPGRADE_LIST.AREA_SIZE_2, UPGRADE_LIST.AREA_SIZE_3,
										UPGRADE_LIST.FRUIT_MAGNET_2, UPGRADE_LIST.FRUIT_MAGNET_3,
										UPGRADE_LIST.HYPER_SPEED_2, UPGRADE_LIST.HYPER_SPEED_3,
										UPGRADE_LIST.DOUBLE_FRUIT_2, UPGRADE_LIST.DOUBLE_FRUIT_3,
										UPGRADE_LIST.FRUIT_RELOCATOR_2, UPGRADE_LIST.FRUIT_RELOCATOR_3,
										UPGRADE_LIST.CROSS_ROAD_2, UPGRADE_LIST.CROSS_ROAD_3,
										UPGRADE_LIST.TIME_STOP_2, UPGRADE_LIST.TIME_STOP_3,
										UPGRADE_LIST.WORMHOLE_2, UPGRADE_LIST.WORMHOLE_3,
										UPGRADE_LIST.DIET_2, UPGRADE_LIST.DIET_3,
										UPGRADE_LIST.FUEL_2, UPGRADE_LIST.FUEL_3,
										UPGRADE_LIST.MAGIC_FLUTE_2, UPGRADE_LIST.MAGIC_FLUTE_3,
										UPGRADE_LIST.SNEK_2, UPGRADE_LIST.SNEK_3,
										UPGRADE_LIST.PACMAN_2, UPGRADE_LIST.PACMAN_3,
										UPGRADE_LIST.BIG_FRUIT_2, UPGRADE_LIST.BIG_FRUIT_3,
										UPGRADE_LIST.DRAGONFLY_2, UPGRADE_LIST.DRAGONFLY_3,
										UPGRADE_LIST.MAYFLY_2, UPGRADE_LIST.MAYFLY_3,
										UPGRADE_LIST.BUMBLEBEE_2, UPGRADE_LIST.BUMBLEBEE_3,]

var upgrades_with_advancement: Array[int] = [	UPGRADE_LIST.AREA_SIZE_1, UPGRADE_LIST.AREA_SIZE_2,
												UPGRADE_LIST.FRUIT_MAGNET_1, UPGRADE_LIST.FRUIT_MAGNET_2,
												UPGRADE_LIST.HYPER_SPEED_1, UPGRADE_LIST.HYPER_SPEED_2,
												UPGRADE_LIST.DOUBLE_FRUIT_1, UPGRADE_LIST.DOUBLE_FRUIT_2,
												UPGRADE_LIST.FRUIT_RELOCATOR_1, UPGRADE_LIST.FRUIT_RELOCATOR_2,
												UPGRADE_LIST.CROSS_ROAD_1, UPGRADE_LIST.CROSS_ROAD_2,
												UPGRADE_LIST.TIME_STOP_1, UPGRADE_LIST.TIME_STOP_2,
												UPGRADE_LIST.WORMHOLE_1, UPGRADE_LIST.WORMHOLE_2,
												UPGRADE_LIST.DIET_1, UPGRADE_LIST.DIET_2,
												UPGRADE_LIST.FUEL_1, UPGRADE_LIST.FUEL_2,
												UPGRADE_LIST.MAGIC_FLUTE_1, UPGRADE_LIST.MAGIC_FLUTE_2,
												UPGRADE_LIST.SNEK_1, UPGRADE_LIST.SNEK_2,
												UPGRADE_LIST.PACMAN_1, UPGRADE_LIST.PACMAN_2,
												UPGRADE_LIST.BIG_FRUIT_1, UPGRADE_LIST.BIG_FRUIT_2,
												UPGRADE_LIST.DRAGONFLY_1, UPGRADE_LIST.DRAGONFLY_2,
												UPGRADE_LIST.MAYFLY_1, UPGRADE_LIST.MAYFLY_2,
												UPGRADE_LIST.BUMBLEBEE_1, UPGRADE_LIST.BUMBLEBEE_2,]


var FRUIT_THRESHOLDS: Array [int] = [5,5,5,5, 6,6,6,6, 7,7,7,7]
const ROUND_TIME_SEC: int = 70
const COLLISION_IFRAMES: int = 4

var node_being_dragged: Node = null

var test_mode = true

func get_upgrade_type(upgrade_id: int):
	
	match upgrade_id:
		UPGRADE_LIST.AREA_SIZE_1, UPGRADE_LIST.AREA_SIZE_2, UPGRADE_LIST.AREA_SIZE_3,\
		UPGRADE_LIST.DEAD_MOUSE:
			return UPGRADE_TYPE.DEFAULT
		UPGRADE_LIST.FRUIT_MAGNET_1, UPGRADE_LIST.FRUIT_MAGNET_2, UPGRADE_LIST.FRUIT_MAGNET_3,\
		UPGRADE_LIST.HYPER_SPEED_1, UPGRADE_LIST.HYPER_SPEED_2, UPGRADE_LIST.HYPER_SPEED_3,\
		UPGRADE_LIST.DOUBLE_FRUIT_1, UPGRADE_LIST.DOUBLE_FRUIT_2, UPGRADE_LIST.DOUBLE_FRUIT_3,\
		UPGRADE_LIST.DIET_1, UPGRADE_LIST.DIET_2, UPGRADE_LIST.DIET_3,\
		UPGRADE_LIST.FUEL_1, UPGRADE_LIST.FUEL_2, UPGRADE_LIST.FUEL_3,\
		UPGRADE_LIST.BIG_FRUIT_1, UPGRADE_LIST.BIG_FRUIT_2, UPGRADE_LIST.BIG_FRUIT_3,\
		UPGRADE_LIST.MAGIC_FLUTE_1, UPGRADE_LIST.MAGIC_FLUTE_2, UPGRADE_LIST.MAGIC_FLUTE_3,\
		UPGRADE_LIST.DRAGONFLY_1, UPGRADE_LIST.DRAGONFLY_2, UPGRADE_LIST.DRAGONFLY_3,\
		UPGRADE_LIST.MAYFLY_1, UPGRADE_LIST.MAYFLY_2, UPGRADE_LIST.MAYFLY_3,\
		UPGRADE_LIST.BUMBLEBEE_1, UPGRADE_LIST.BUMBLEBEE_2, UPGRADE_LIST.BUMBLEBEE_3:
			return UPGRADE_TYPE.PASSIVE
		UPGRADE_LIST.FRUIT_RELOCATOR_1, UPGRADE_LIST.FRUIT_RELOCATOR_2, UPGRADE_LIST.FRUIT_RELOCATOR_3,\
		UPGRADE_LIST.CROSS_ROAD_1, UPGRADE_LIST.CROSS_ROAD_2, UPGRADE_LIST.CROSS_ROAD_3,\
		UPGRADE_LIST.TIME_STOP_1, UPGRADE_LIST.TIME_STOP_2, UPGRADE_LIST.TIME_STOP_3,\
		UPGRADE_LIST.PACMAN_1, UPGRADE_LIST.PACMAN_2, UPGRADE_LIST.PACMAN_3,\
		UPGRADE_LIST.SNEK_1, UPGRADE_LIST.SNEK_2, UPGRADE_LIST.SNEK_3,\
		UPGRADE_LIST.WORMHOLE_1, UPGRADE_LIST.WORMHOLE_2, UPGRADE_LIST.WORMHOLE_3:
			return UPGRADE_TYPE.ACTIVE
		UPGRADE_LIST.TAIL_CUT,\
		UPGRADE_LIST.CORNER_PHASING,\
		UPGRADE_LIST.COATING,\
		UPGRADE_LIST.STEEL_HELMET,\
		UPGRADE_LIST.PLANT_SNAKE,\
		UPGRADE_LIST.DIFFUSION,\
		UPGRADE_LIST.HEAD_LIGHT,\
		UPGRADE_LIST.RUBBER_BAND:
			return UPGRADE_TYPE.BODYMOD
		UPGRADE_LIST.KNOT_SLOWMO,\
		UPGRADE_LIST.ITEM_RELOADER,\
		UPGRADE_LIST.PIGGY_BANK,\
		UPGRADE_LIST.SWISS_KNIVE,\
		UPGRADE_LIST.SHINY_GHOST,\
		UPGRADE_LIST.SALE,\
		UPGRADE_LIST.CATCH,\
		UPGRADE_LIST.POWER_NAP:
			return UPGRADE_TYPE.SYNERGY
		UPGRADE_LIST.IMMUTABLE,\
		UPGRADE_LIST.MOULTING,\
		UPGRADE_LIST.EDGE_WRAP,\
		UPGRADE_LIST.DANCE,\
		UPGRADE_LIST.HALF_GONE,\
		UPGRADE_LIST.ALLERGY,\
		UPGRADE_LIST.OVERFED,\
		UPGRADE_LIST.ANCHOR:
			return UPGRADE_TYPE.SPECIAL
		_:
			print_debug("notype has been found for this upgrade: " + str(upgrade_id))

func _ready() -> void:
	if test_mode:
		FRUIT_THRESHOLDS = [0,0,0,0, 0,0,0,0, 0,0,0,0]
